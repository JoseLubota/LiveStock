@model LiveStock.Web.ViewModels.HomeSummaryViewModel
@{
    ViewData["Title"] = "LiveStock — Farm Management";
}

<!-- Home: Farm Owner Landing -->
<section class="hero-section pt-2 pb-4">
    <div class="container">
        <div class="hero-banner" style="background-image: url('@Url.Content("~/Images/IMG-20251025-WA0032.jpg")'); background-size: cover; background-position: center; border-radius: 12px; position: relative;">
            <div class="hero-overlay"></div>
            <div class="hero-content">
                <h1 class="mb-3">Welcome to LiveStock</h1>
                <p class="lead mb-4">
                    <a class="btn btn-warning" asp-area="" asp-controller="Account" asp-action="Login">Login</a>
                </p>
            </div>
        </div>
    </div>
</section>

<!-- Farm at a Glance -->
<section class="py-4">
    <div class="container">
        <h2 class="h4 mb-3">Farm at a Glance</h2>
        <div class="row g-3">
            <div class="col-6 col-md-4 col-lg-2">
                <div class="metric-card text-center">
                    <div class="metric-value">@Model?.LivestockCount</div>
                    <div class="text-muted">Livestock</div>
                </div>
            </div>
            <div class="col-6 col-md-4 col-lg-2">
                <div class="metric-card text-center">
                    <div class="metric-value">@Model?.ActiveStaffCount</div>
                    <div class="text-muted">Active Staff</div>
                </div>
            </div>
            <div class="col-6 col-md-4 col-lg-2">
                <div class="metric-card text-center">
                    <div class="metric-value">@Model?.CampCount</div>
                    <div class="text-muted">Camps</div>
                </div>
            </div>
            <div class="col-6 col-md-4 col-lg-3">
                <div class="metric-card text-center">
                    <div class="metric-value">@Model?.OpenTaskCount</div>
                    <div class="text-muted">Open Tasks</div>
                </div>
            </div>
            <div class="col-6 col-md-4 col-lg-3">
                <div class="metric-card text-center">
                    <div class="metric-value">R @Model?.NetProfit.ToString("N2")</div>
                    <div class="text-muted">Net Profit</div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Today’s Highlights -->
<section class="py-4 bg-light">
    <div class="container">
        <h2 class="h4 mb-3">Today’s Highlights</h2>
        <div class="row g-3">
            <div class="col-md-6">
                <div class="p-3 border rounded h-100">
                    <h3 class="h6">Summary</h3>
                    @if (Model?.TodayHighlights?.Any() == true)
                    {
                        <ul class="mb-0">
                            @foreach (var h in Model.TodayHighlights) { <li>@h</li> }
                        </ul>
                    }
                    else
                    {
                        <div class="text-muted">No highlights yet today.</div>
                    }
                </div>
            </div>
            <div class="col-md-6">
                <div class="p-3 border rounded h-100">
                    <h3 class="h6">Recent Notes</h3>
                    @if (Model?.RecentNotes?.Any() == true)
                    {
                        <ul class="mb-0">
                            @foreach (var n in Model.RecentNotes)
                            {
                                <li><span class="badge bg-success me-2">@n.Category</span>@n.Title <span class="text-muted">(@n.When)</span></li>
                            }
                        </ul>
                    }
                    else
                    {
                        <div class="text-muted">No recent notes.</div>
                    }
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Featured Photos -->
<section class="py-4">
    <div class="container">
        <div id="farmCarousel" class="carousel slide shadow rounded overflow-hidden" data-bs-ride="carousel">
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="~/Images/IMG-20251025-WA0028.jpg" class="d-block w-100" alt="Grazing livestock">
                </div>
                <div class="carousel-item">
                    <img src="~/Images/IMG-20251025-WA0032.jpg" class="d-block w-100" alt="Farm landscape">
                </div>
                <div class="carousel-item">
                    <img src="~/Images/IMG-20251025-WA0034.jpg" class="d-block w-100" alt="Water trough">
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#farmCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#farmCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#farmCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#farmCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button" data-bs-target="#farmCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
            </div>
        </div>
    </div>
</section>

<!-- Overview with tooltips -->
<section class="py-4">
    <div class="container">
        <h2 class="h4 mb-3">What you can do</h2>
        <div class="row g-3">
            <div class="col-md-4">
                <div class="p-3 border rounded h-100" title="Manage sheep and cows records">
                    <i class="fas fa-seedling module-icon me-2"></i>
                    Manage sheep and cows records and statuses.
                </div>
            </div>
            <div class="col-md-4">
                <div class="p-3 border rounded h-100" title="Manage camps and rainfall by location">
                    <i class="fa-solid fa-map-location-dot module-icon me-2"></i>
                    Manage camps across your farm and monitor rainfall per camp.
                </div>
            </div>
            <div class="col-md-4">
                <div class="p-3 border rounded h-100" title="Organize staff and assign tasks">
                    <i class="fa-solid fa-users module-icon me-2"></i>
                    Organize staff, assign tasks, and track progress.
                </div>
            </div>
            <div class="col-md-4">
                <div class="p-3 border rounded h-100" title="Record water and rainfall events">
                    <i class="fa-solid fa-droplet module-icon me-2"></i>
                    Record water and rainfall events and view history.
                </div>
            </div>
            <div class="col-md-4">
                <div class="p-3 border rounded h-100" title="Maintain assets and equipment">
                    <i class="fa-solid fa-wrench module-icon me-2"></i>
                    Maintain assets and equipment lifecycle.
                </div>
            </div>
            <div class="col-md-4">
                <div class="p-3 border rounded h-100" title="Track finances and expenses">
                    <i class="fa-solid fa-dollar-sign module-icon me-2"></i>
                    Track finance records and farm expenses.
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Role-specific onboarding tips -->
<section class="py-4 bg-light">
    <div class="container">
        <h2 class="h4 mb-3">Onboarding Tips</h2>
        <div class="row g-3">
            <div class="col-md-6">
                <div class="p-3 border rounded h-100">
                    <h3 class="h6">Admin</h3>
                    <ul>
                        <li>Assign tasks to staff members on the Tasks page.</li>
                        <li>Track the financial health of the farm on the Finance page.</li>
                        <li>Audit assets monthly.</li>
                    </ul>
                </div>
            </div>
            <div class="col-md-6">
                <div class="p-3 border rounded h-100">
                    <h3 class="h6">Staff</h3>
                    <ul>
                        <li>Check your dashboard for assigned tasks.</li>
                        <li>Leave notes when you encounter issues or have questions.</li>
                        <li>Send messages to communicate with the farm owner or other staff members.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- How-To section -->
<section class="py-4">
    <div class="container">
        <h2 class="h4 mb-3">How-To</h2>
        <ol class="mb-4">
            <li>Click <strong>Login</strong> in the top-right of the navigation bar.</li>
            <li>Enter your admin or staff credentials to sign in.</li>
            <li>After login, use the sidebar in your <strong>Dashboard</strong> to access modules.</li>
            <li>Common workflows: Add rainfall, assign tasks, record notes, update livestock records.</li>
        </ol>
    </div>
</section>



@section Scripts {
<script>
(function(){
  try {
    var key = 'homeAnnouncementsDismissed';
    var dismissed = localStorage.getItem(key);
    var card = document.getElementById('announcements');
    var btn = document.getElementById('dismissAnnouncements');
    if (dismissed === 'true' && card) { card.style.display = 'none'; }
    if (btn) {
      btn.addEventListener('click', function(){
        localStorage.setItem(key, 'true');
        if (card) card.style.display = 'none';
      });
    }
  } catch(e) { /* ignore */ }
})();
</script>
}

<style>
    .carousel-item img {
        max-height: 420px;
        object-fit: cover;
    }
    .hero-banner {
        min-height: 70vh;
        background-repeat: no-repeat;
    }
    .hero-overlay {
        position: absolute;
        inset: 0;
        background-color: rgba(0,0,0,0.45);
        border-radius: 12px;
    }
    .hero-content {
        position: relative;
        z-index: 1;
        background-color: transparent;
        color: #fff;
        width: 100%;
        height: 100%;
        padding: 3rem 2rem;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: flex-start;
        gap: 1rem;
    }
</style>
